{% extends "base.html" %}
{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/grados.css') }}">

<div class="page-header">
    <div class="container">
        <h1 class="page-title"><i class="fas fa-edit"></i> Editar Grado</h1>
        <p class="page-subtitle">Formulario para modificar la información del grado</p>
    </div>
</div>

<div class="container">
    <!-- Mensajes flash -->
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            {% endfor %}
        {% endif %}
    {% endwith %}
    
    <div class="form-container">
        <form method="POST" id="formEditarGrado">
            <div class="form-section">
                <h3 class="section-title"><i class="fas fa-cog"></i> Información del Grado</h3>

                <div class="form-group">
                    <label for="nombre_grado" class="form-label required-field">Nombre del Grado</label>
                    <div class="input-icon">
                        <i class="fas fa-school"></i>
                        <input type="text" name="nombre_grado" id="nombre_grado" class="form-control" value="{{ grado.nombre_grado }}" required maxlength="50">
                    </div>
                    <div class="invalid-feedback" id="nombreError"></div>
                </div>

                <div class="form-group">
                    <label for="nivel" class="form-label required-field">Nivel</label>
                    <div class="input-icon">
                        <i class="fas fa-layer-group"></i>
                        <select name="nivel" id="nivel" class="form-control" required>
                            <option value="">Seleccione un nivel</option>
                            <option value="Parvularia" {% if grado.nivel == 'Parvularia' %}selected{% endif %}>Parvularia</option>
                            <option value="Básico" {% if grado.nivel == 'Básico' %}selected{% endif %}>Básico</option>
                            <option value="Bachillerato" {% if grado.nivel == 'Bachillerato' %}selected{% endif %}>Bachillerato</option>
                        </select>
                    </div>
                    <div class="invalid-feedback" id="nivelError"></div>
                </div>

                <div class="form-group">
                    <label for="orden" class="form-label required-field">Orden de Progresión</label>
                    <div class="input-icon">
                        <i class="fas fa-sort-numeric-up"></i>
                        <input type="number" name="orden" id="orden" class="form-control" value="{{ grado.orden }}" required min="1" max="100" placeholder="1-16">
                    </div>
                    <div class="invalid-feedback" id="ordenError"></div>
                    <small class="form-text text-muted">Orden de progresión: Parvularia (1-4), Básico (5-13), Bachillerato (14-16)</small>
                </div>
            </div>

            <div class="action-buttons">
                <button type="submit" class="btn btn-success"><i class="fas fa-save"></i> Guardar Cambios</button>
                <a href="{{ url_for('grados.lista_grados') }}" class="btn btn-secondary"><i class="fas fa-times"></i> Cancelar</a>
            </div>
        </form>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function(){
    const form = document.getElementById('formEditarGrado');
    form.addEventListener('submit', function(e){
        let valid = true;

        const nombre = document.getElementById('nombre_grado');
        if(nombre.value.trim() === ""){
            document.getElementById('nombreError').textContent = "Este campo es obligatorio";
            nombre.classList.add('is-invalid');
            valid=false;
        } else { nombre.classList.remove('is-invalid'); }

        const nivel = document.getElementById('nivel');
        if(nivel.value.trim() === ""){
            document.getElementById('nivelError').textContent = "Este campo es obligatorio";
            nivel.classList.add('is-invalid');
            valid=false;
        } else { nivel.classList.remove('is-invalid'); }

        if(!valid) e.preventDefault();
    });
});
</script>

{% endblock %}
